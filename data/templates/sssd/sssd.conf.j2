{# j2lint: disable=S7  #}
# Automatically generated by system-login.py
# SSSD configuration file

{% if sssd is vyos_defined %}
[sssd]
config_file_version = 2
services = nss, pam

domains = {% for domain in sssd.ipa_domain %}{{ domain }}{% if not loop.last %},{% endif %}{% endfor %}

[nss]

[pam]

{%     for domain in sssd.ipa_domain %}
[domain/{{ domain }}]
{%         if sssd.ipa_domain[domain].cache_credentials is vyos_defined %}cache_credentials = True
{%         endif %}
{%         if sssd.ipa_domain[domain].krb5_store_password_if_offline %} krb5_store_password_if_offline = True
{%         endif %}
ipa_domain = {{ domain }}
id_provider = ipa
auth_provider = ipa
access_provider = ipa
ipa_hostname = {{ sssd.ipa_domain[domain].ipa_hostname }}
chpass_provider = ipa
ipa_server = {{ sssd.ipa_domain[domain].ipa_server or '_srv_' }}
ldap_tls_cacert = /run/sssd/{{ sssd.ipa_domain[domain].ca_certificate }}_ca.crt
krb5_keytab = /run/krb5/keytab/{{ sssd.ipa_domain[domain].sanitized_keytab_name }}

{%     endfor %}
{% endif %}
